<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1" />

    <!-- <link rel="stylesheet" type="text/css" href="css/main.css" /> -->
<!-- Latest compiled and minified CSS -->

    <!-- <link rel="stylesheet" href="assets/css/main.css" /> -->
    <link rel="stylesheet" type="text/css" href="css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="css/bootstrap-theme.min.css" />
    <link rel="stylesheet" type="text/css" href="css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css"/>
    <link rel="stylesheet" type="text/css" href="css/primary.css" />

    <title>Ingredient Printer</title>
    <style>
      .btn span.glyphicon {   opacity: 0; }
      .btn.active span.glyphicon {   opacity: 1; }
      
  /*    glyphicon{
          font-size: 3px;
          height:5px;
      }*/
    </style>
  </head>
<body>
    <div class="app">
        <h1>Ingredient Printer</h1>
        <div id="mainPage">
            <ul id="deviceList">
            </ul>
            <button id="refreshButton">Refresh</button>
        </div>
        <div id="detailPage">
            <div id="resultDiv"></div>
            <div>
                <input type="text" id="messageInput" value="Hello"/>
                <button id="sendButton">Send</button>
            </div>
            <button id="disconnectButton">Disconnect</button>
        </div>
        <div id="statusDiv"></div>
    </div>
        <div class="container">
                <!-- <span class="image fit primary"><img src="images/pic01.jpg" alt="" /></span> -->
                <div class="content">
                    <header class="major">
                        <h2>Custom Recipe</h2>
                    </header>
                    <br>

                    <form id="form1" name="form1"type="text">
                    <div class="row uniform">
                        <div class="col-sm-" style="transform: translate(0px,0px);">
                            <!-- <input type="checkbox" id="pause1">Pause</input> -->
                            <input type="text" name="In1" id="email" style="width:128px; height:35px; transform: translate(0px,-2px);" placeholder="Quantity of Flour" /> 
                            <select id="units1" name="units1" style="width:130px; ">
                                  <option value="0">    Grams               </option>
                                  <option value="1">    Cups                </option>
                                  <option value="2">    Ounces              </option>
                                  <option value="3">    Tablespoons         </option>
                                  <option value="4">    Teaspoons           </option>
                                  <option value="5">    Pints               </option>
                                  <option value="6">    Quarts              </option>
                                  <option value="7">    Liters              </option>
                                  <option value="8">    Gallons             </option>
                            </select>
                            <div class="btn-group" data-toggle="buttons">
                                <label class="btn btn-default btn-xs">
                                    <input type="checkbox" id="pause1" autocomplete="off">
                                    <span class="glyphicon glyphicon-ok fa-sm"></span>
                                </label>            
                            </div>
                        </div><br>
                        <div class="6u$(xsmall)" style="transform: translate(0px,0px);">

                            <!-- <div class ="btn btn-primary"><input type="checkbox" id="pause2">Pause</input> -->
                            <!-- </div> -->

                            <input type="text" name="In2" id="email"style="width:128px; height:35px; transform: translate(0px,-2px);" placeholder="Quantity of Sugar" /> 
                            <select id="units2" name="units2"  style="width:130px ">
                                  <option value="0">    Grams               </option>
                                  <option value="1">    Cups                </option>
                                  <option value="2">    Ounces              </option>
                                  <option value="3">    Tablespoons         </option>
                                  <option value="4">    Teaspoons           </option>
                                  <option value="5">    Pints               </option>
                                  <option value="6">    Quarts              </option>
                                  <option value="7">    Liters              </option>
                                  <option value="8">    Gallons             </option>
                            </select>
                            <div class="btn-group" data-toggle="buttons">
                            <label class="btn btn-default btn-xs">
                                <input type="checkbox" id="pause2" autocomplete="off">
                                <span class="glyphicon glyphicon-ok fa-sm"></span>
                            </label>            
                            </div>
                            </div><br>
                        <div class="6u$(xsmall)" style="transform: translate(0px,0px);">
                            <!-- <input type="checkbox" id="pause3">Pause</input> -->
                            <input type="text" name="In3" id="email"style="width:128px; height:35px; transform: translate(0px,-2px);" placeholder="Quantity of Milk" />  
                            <select id="units3" name="units3" style="width:130px;">
                                  <option value="0">    Grams               </option>
                                  <option value="1">    Cups                </option>
                                  <option value="2">    Ounces              </option>
                                  <option value="3">    Tablespoons         </option>
                                  <option value="4">    Teaspoons           </option>
                                  <option value="5">    Pints               </option>
                                  <option value="6">    Quarts              </option>
                                  <option value="7">    Liters              </option>
                                  <option value="8">    Gallons             </option>
                            </select>
                            <div class="btn-group" data-toggle="buttons">
                            <label class="btn btn-default btn-xs">
                                <input type="checkbox" id="pause3" autocomplete="off">
                                <span class="glyphicon glyphicon-ok fa-sm"></span>
                            </label>            
                            </div>
                        </div><br>
                        <div class="6u$(xsmall)" style="transform: translate(0px,0px);">
                            <!-- <input type="checkbox" id="pause4">Pause</input> -->
                            <input type="text" name="In4" id="email"style="width:128px; height:35px; transform: translate(0px,-2px);" placeholder="Quantity of Water" /> 
                            <select id="units4" name="units4" style="width:130px;">
                                  <option value="0">    Grams               </option>
                                  <option value="1">    Cups                </option>
                                  <option value="2">    Ounces              </option>
                                  <option value="3">    Tablespoons         </option>
                                  <option value="4">    Teaspoons           </option>
                                  <option value="5">    Pints               </option>
                                  <option value="6">    Quarts              </option>
                                  <option value="7">    Liters              </option>
                                  <option value="8">    Gallons             </option>
                            </select>
                            <div class="btn-group" data-toggle="buttons">
                            <label class="btn btn-default btn-xs">
                                <input type="checkbox" id="pause4" autocomplete="off">
                                <span class="glyphicon glyphicon-ok fa-sm"></span>
                            </label>            
                        </div>
                        </div><br>
                    <li id="printer" style ="text-align: center; text-decoration: none; list-style:none; transform: translate(20px,0px); border-top:0;"><a href="#one" class="button special" onclick="printer()">PRINT</a></li>
                    <p id="input1err" style="text-align:center; color:red;" class ="err"></p>

            <div>
                </form>
                </div>
            </div>

            <a href="#three" style="transform: translate(0px,30px);"class="goto-next scrolly">Next</a>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
            <section id="three" style="transform: translate(0px,-70px);">
            <div class="container">
                <div class="content">
                    <header class="major">
                        <h2>Select Recipe</h2>
                    </header>
                    <p>Submit a recipe from preapproved vendors.</p>
                        <div class="12u"><input type="text" name="name" id="name" style="width:190px;height:35px;" placeholder="Enter URL..." /></div>

                    <div class="list-group" style="-webkit-box-shadow: none;-moz-box-shadow: none;box-shadow: none;">
                      <a href="http://www.bonappetit.com/recipes" class="list-group-item" style="width:300px; height:90px; transform: translate(9px,20px);" >
                        <img src="bonappetit.png" style = "width:180px; display: block; margin: 15px 0px 10px 40px;" class="imgs" alt=""/>
                      </a>
                      <a href="http://www.epicurious.com/" class="list-group-item" style="width:300px; height:90px; transform: translate(9px,20px);" >
                        <img src="Epicurious.png" style = "width:180px; display: block; margin: 15px 0px 10px 40px;" class="imgs" alt="" />
                      </a>
                      <a href="http://allrecipes.com/" class="list-group-item" style="width:300px; height:90px; transform: translate(9px,20px);" >
                        <img src="allrecipes.png" style = "width:180px;" alt=""/>
                      </a>
                      <a href="http://www.yummly.com/" class="list-group-item" style="width:300px; height:90px; transform: translate(9px,20px);" >
                        <img src="Yummly.png" style = "height:50px; width:160px; display: block; margin: 12px 0px 10px 53px;" alt=""/>
                      </a>
                    </div>
            </div>
        </section>
    <script>
// Currently Supported Units of measure: 
// g = g
// 125g = 1cup
// 28.3g=oz
// 15g = Tbsp

// 2cup=1pint
// 2pint=1Liter
// 4Quart = 1Gal
//4L = 1Gal
//
                                             //g, cups,   oz,     Tbsp,    tsp,    pint,     quart,     liter, gallon
var flour_multiplier =  [1, 125,    28.35,  7.5,     3.13,   250,      500,       500,   2000];//Unit multiplier for
var sugar_multiplier =  [1, 200,    28.35,  14,      4,      100,      200,       200,   800];   
var milk_multiplier =   [1, 236.59, 29.5735,14.7868, 4.9289, 473.1765, 1000.0018, 946.353,3785.412];
var water_multiplier =  [1, 236.59, 29.5735,14.7868, 4.9289, 473.1765, 1000.0018, 946.353,3785.412];     
var units =["Grams", "Cups","Ounces","Tablespoons","Teaspoons","Pints","Quarts", "Liters", "Gallons"];

function printer(){
var form1,i;
    var q = []; //quantities
    var arrnum = 0;//starting with zero
    var select1,select2,select3,select4;
    var ctrlword;

    form1=document.getElementById("form1");

        q[0] = form1.elements["In1"].value; //Ingredient1 Quantity
        q[1] = form1.elements["In2"].value;
        q[2] = form1.elements["In3"].value;
        q[3] = form1.elements["In4"].value;

    //FORM VALIDATION 
  var numbers =  /^[-+]?[0-9]+\.[0-9]+$/; // /^[0-9]+$/;

        //if no input, output error to user
    if(!q[0] && !q[1] && !q[2] && !q[3]){
        document.getElementById("input1err").innerHTML = "Error: No values entered, form invalid";
        console.log(q[0]+ q[1]+ q[2]+ q[3]);
    }
    //if input values aren't integers, output error to user 
    // else if((q[0] && !q[0].match(numbers)) || (q[1] && !q[1].match(numbers)) || (q[2] && !q[2].match(numbers)) || (q[3] && !q[3].match(numbers))){  
    //     // if(q1console.log("not int");
    //     document.getElementById("input1err").innerHTML ='Error: Please input positive quantity (ie. 1, 1.2, etc.)';  
    //     document.form1.In1.focus();  
    //     return false;  
    // }  
   //If quantity is specified, extract units of measure
    else {
            if(q[0]){
                select1 = form1.units1;                     //Units of measure
                q[0] = parseInt(q[0]*flour_multiplier[select1[select1.selectedIndex].value]);
                arrnum++;
            }
            if(q[1]){
                select2 = form1.units2; 
                q[1] = parseInt(q[1]*sugar_multiplier[select2[select2.selectedIndex].value]);
                arrnum++;
            }       
            if(q[2]){
                select3 = form1.units3; 
                q[2] = parseInt(q[2]*milk_multiplier[select3[select3.selectedIndex].value]);
                arrnum++;
            }
            if(q[3]){
                select4 = form1.units4; 
                q[3] = parseInt(q[3]*water_multiplier[select4[select4.selectedIndex].value]);
                arrnum++;
            }
         var ctrlword = arrnum-1 + ",";

         for(i = 0; i < 4; i ++){
            if(q[i]){
              var j = 1 + i;
                if(document.getElementById("pause"+j).checked){
                    var p = "P";
                } else {p  = "N";}
                ctrlword += i + "," + q[i] + "," + p + ",";   
                }
            }
            ctrlword += "*";
            // console.log(units[select1[select1.selectedIndex].value]);
            // console.log("control word = " + ctrlword);
            // console.log("pause val = " + document.getElementById("pause1").checked);
        document.getElementById("input1err").innerHTML = "control word = " + ctrlword;

        var success = function() {
        console.log("success");
        resultDiv.innerHTML = resultDiv.innerHTML + "Sent: " + ctrlword + "<br/>";
        resultDiv.scrollTop = resultDiv.scrollHeight;
         };

        var failure = function() {
            alert("Failed writing data to Bluetooth peripheral");
        };

        var data = ctrlword;//messageInput.value;
        bluetoothSerial.write(data, success, failure);
}        

}
  </script>
    <script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="js/main.js"></script>
    <script type="text/javascript" src="js/jquery-1.12.3.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.js"></script>

    <script type="text/javascript">
        app.initialize();
   </script>
</body>
</html>
